# LR(1)语法分析器

这是一个基于Python实现的LR(1)语法分析器，用于分析算术表达式。提供了命令行界面和图形用户界面(GUI)两种使用方式。

## 支持的文法

该分析器支持以下文法规则：

1. E→E+T
2. E→E-T
3. E→T
4. T→T*F
5. T→T/F
6. T→F
7. F→(E)
8. F→i

其中，E、T、F是非终结符，+、-、*、/、(、)、i是终结符，i代表标识符或数字。

## 安装依赖

要运行图形界面版本，需要安装PyQt6：

```bash
pip install -r requirements.txt
```

## 程序结构

程序由以下几个部分组成：

1. ACTION表：定义对当前状态和输入符号的动作
2. GOTO表：定义状态转换
3. 产生式表：定义文法产生式
4. 分析算法：实现LR(1)分析过程

### 文件说明

- `lr1_parser.py`: 核心分析器实现
- `batch_test.py`: 批量测试工具
- `lr1_gui.py`: 图形用户界面
- `grammar_parser.py`: 文法解析器（用于解析用户输入的文法）
- `run.py`: 启动脚本
- `test_cases.txt`: 测试用例文件
- `requirements.txt`: 依赖库文件

### 类与函数说明

- `LR1Parser`类（在`lr1_parser.py`中）：实现LR(1)语法分析
  - `__init__`：初始化ACTION表、GOTO表和产生式
  - `parse`：执行语法分析，输出分析过程
- `LR1AnalyzerGUI`类（在`lr1_gui.py`中）：实现图形用户界面
  - 提供分析器、批量测试、文法查看和ACTION/GOTO表查看功能
- `GrammarParser`类（在`grammar_parser.py`中）：解析用户输入的文法

## 使用方法

### 启动程序

```bash
# 启动GUI界面（默认）
python run.py

# 使用命令行界面
python run.py --cli

# 运行批量测试
python run.py --batch

# 指定测试文件
python run.py --batch --file my_test_cases.txt
```

### 命令行界面使用

1. 运行命令行界面：
```bash
python run.py --cli
```

2. 输入要分析的符号串，例如：`i+i*i#`

3. 程序会输出分析步骤，包括：
   - 步骤编号
   - 状态栈内容
   - 符号栈内容
   - 剩余输入串
   - 执行的动作

### 图形界面使用

图形界面包含以下几个功能选项卡：

1. **分析器**：输入符号串并分析
   - 输入框：输入要分析的符号串
   - 分析按钮：执行分析过程
   - 示例按钮：快速选择预设的示例
   - 分析结果表格：显示分析步骤

2. **批量测试**：加载测试用例文件并批量测试
   - 选择测试文件
   - 测试用例列表：显示测试文件中的所有用例
   - 测试按钮：执行测试
   - 测试结果显示：表格形式展示分析过程

3. **文法**：查看支持的文法和产生式
   - 文法规则说明
   - 产生式表格

4. **分析表**：显示ACTION表和GOTO表
   - ACTION表：展示各个状态下对不同输入符号的动作
   - GOTO表：展示状态转换规则

5. **关于**：程序介绍和使用说明

## 示例

输入：`i+i*i#`

输出过程：
```
步骤   状态栈              符号栈              剩余输入串          动作     
1     0                 #                 i+i*i#             移进     
2     05                #i                +i*i#              r6: F→i归约
3     03                #F                +i*i#              r4: T→F归约
4     02                #T                +i*i#              r2: E→T归约
5     01                #E                +i*i#              移进     
6     016               #E+               i*i#               移进     
7     0165              #E+i              *i#                r6: F→i归约
8     0163              #E+F              *i#                r4: T→F归约
9     0169              #E+T              *i#                移进     
10    01697             #E+T*             i#                 移进     
11    016975            #E+T*i            #                  r6: F→i归约
12    0169710           #E+T*F            #                  r3: T→T*F归约
13    0169              #E+T              #                  r1: E→E+T归约
14    01                #E                #                  接受     
```

## 测试用例

项目包含了一组测试用例（test_cases.txt），包括：
- 合法表达式
- 非法表达式

可以通过批量测试功能验证分析器的正确性。

## 注意事项

1. 输入字符串必须以`#`结尾，表示输入结束
2. 只支持单字符的标识符`i`，不支持多字符标识符
3. 只支持基本的算术运算符：+、-、*、/和括号

## 程序设计思想

LR(1)分析器是一种自底向上的语法分析方法，通过预先构建的分析表指导分析过程。该程序实现了完整的LR(1)分析流程：

1. 初始化状态栈和符号栈
2. 根据当前状态和输入符号查询ACTION表决定动作
3. 执行移进、归约或接受动作
4. 如果发生错误，给出错误提示

程序使用了面向对象的设计，将分析器、界面和文法解析等功能封装为不同的类，便于扩展和维护。图形界面使用PyQt6实现，提供了直观的交互方式，方便用户使用。 